
---

# 📘 Lesson 3: NumPy Advanced

---

## **1. Array shape (reshape, flatten)**

* **reshape** → ផ្លាស់ប្តូរ shape នៃ array ដោយមិនប្ដូរតម្លៃ
* **flatten** → បម្លែង array ជា 1D array

```python
import numpy as np

# Create a 1D array with 12 elements
arr = np.arange(12)
print("Original array:", arr)

# Reshape to 3x4
arr2d = arr.reshape(3,4)
print("Reshaped array 3x4:\n", arr2d)

# Reshape to 2x2x3 (3D array)
arr3d = arr.reshape(2,2,3)
print("Reshaped array 2x2x3:\n", arr3d)

# Flatten the 3D array to 1D
flat = arr3d.flatten()
print("Flattened array:", flat)
```

---

## **2. Matrix operations**

```python
# Create 2D arrays (matrices)
A = np.array([[1,2],
              [3,4]])
B = np.array([[5,6],
              [7,8]])

# Transpose
print("A Transpose:\n", A.T)

# Dot product (matrix multiplication)
C = np.dot(A, B)
print("Dot product A·B:\n", C)

# Element-wise multiplication
print("Element-wise multiplication:\n", A * B)

# Inverse (use np.linalg.inv)
A_inv = np.linalg.inv(A)
print("Inverse of A:\n", A_inv)

# Verify: A * A_inv = Identity
identity = np.dot(A, A_inv)
print("A · A_inv:\n", identity)
```

---

## **3. Broadcasting rules**

* Broadcasting → អនុញ្ញាតឲ្យ **array sizes មិនដូចគ្នា** ត្រូវគ្នាដើម្បីប្រើ operations
* Example:

```python
# 1D array
a = np.array([1,2,3])

# 2D array
b = np.array([[10],[20],[30]])  # shape (3,1)

# Broadcasting: add a (1D) to b (2D)
result = a + b
print("Broadcasting result:\n", result)
```

✅ Broadcasting rules:

1. ចាប់ពី dimension ចុងក្រោយ ត្រូវតែដូចគ្នា ឬ មាន size=1
2. Numpy automatically **expand** size=1 dimension

---

## **4. Random numbers**

```python
# Uniform distribution [0,1)
rand_uniform = np.random.rand(3,3)
print("Random uniform 3x3:\n", rand_uniform)

# Standard normal distribution (mean=0, std=1)
rand_normal = np.random.randn(3,3)
print("Random normal 3x3:\n", rand_normal)

# Random integers (low inclusive, high exclusive)
rand_int = np.random.randint(0,10,(3,3))
print("Random integers 3x3:\n", rand_int)
```

* `np.random.rand()` → Uniform \[0,1)
* `np.random.randn()` → Normal (Gaussian) mean=0, std=1
* `np.random.randint(low, high, size)` → Random integers

---

## ✅ Tips

1. **reshape & flatten** → flexible for data preprocessing
2. **Matrix operations** → important for linear algebra, ML, AI
3. **Broadcasting** → powerful tool for element-wise operation without loop
4. **Random numbers** → useful for testing, simulations, machine learning

---
